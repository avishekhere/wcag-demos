<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>WCAG 2.1 â€“ 4.1.3: Accessible Status Messages</title>

<style>
  body {
    font-family: Arial, sans-serif;
    background: #f7f7fb;
    margin: 0;
    padding: 0;
    color: #111;
  }
  .wrap {
    max-width: 800px;
    margin: 30px auto;
    padding: 20px;
    background: #fff;
    border-radius: 12px;
  }

  input, select {
    padding: 6px;
    margin-bottom: 10px;
    width: 100%;
    max-width: 300px;
  }

  button {
    padding: 8px 16px;
    background: #0b7a2a;
    color: #fff;
    border: none;
    border-radius: 6px;
  }

  .status {
    margin-top: 12px;
    padding: 10px;
    border-radius: 6px;
  }

  .safe {
    background: #e9f7ed;
    color: #0b7a2a;
  }

  .unsafe {
    background: #fff1f1;
    color: #b70f0f;
  }

  /* Visually hidden but screen-reader available */
  .visually-hidden {
    position: absolute;
    left: -9999px;
    width: 1px;
    height: 1px;
    overflow: hidden;
  }
</style>
</head>

<body>
<div class="wrap">
  <h1>Accessible Status Message Demo</h1>

  <label for="status-type">Status Type:</label>
  <select id="status-type">
    <option value="unsafe">Unsafe (not announced)</option>
    <option value="safe">Safe (ARIA live)</option>
  </select>

  <form id="demo-form" novalidate>
    <label for="name">Name:</label>
    <input id="name" type="text">

    <label for="email">Email:</label>
    <input id="email" type="email">

    <button type="submit">Submit</button>
  </form>

  <!-- SUCCESS MESSAGE -->
  <div
    id="status-message"
    class="status safe visually-hidden"
    role="status"
    aria-live="polite"
    aria-atomic="true">
  </div>

  <!-- ERROR MESSAGE -->
  <div
    id="field-errors"
    class="status safe visually-hidden"
    role="alert"
    aria-atomic="true">
  </div>
</div>

<script>
const form = document.getElementById('demo-form');
const status = document.getElementById('status-message');
const fieldErrors = document.getElementById('field-errors');
const statusType = document.getElementById('status-type');

form.addEventListener('submit', function (e) {
  e.preventDefault();

  const name = document.getElementById('name').value.trim();
  const email = document.getElementById('email').value.trim();

  // Reset
  status.textContent = '';
  fieldErrors.textContent = '';

  status.classList.add('visually-hidden');
  fieldErrors.classList.add('visually-hidden');

  const isSafe = statusType.value === 'safe';

  if (!name || !email) {
    fieldErrors.textContent = 'Please enter both name and email.';
    fieldErrors.className = `status ${isSafe ? 'safe' : 'unsafe'}`;
    fieldErrors.classList.remove('visually-hidden');

    if (!isSafe) {
      fieldErrors.removeAttribute('role');
    } else {
      fieldErrors.setAttribute('role', 'alert');
    }
    return;
  }

  // SUCCESS (this WILL be announced)
  status.textContent = 'Your form has been successfully submitted.';
  status.className = `status ${isSafe ? 'safe' : 'unsafe'}`;
  status.classList.remove('visually-hidden');

  if (!isSafe) {
    status.removeAttribute('role');
    status.removeAttribute('aria-live');
  } else {
    status.setAttribute('role', 'status');
    status.setAttribute('aria-live', 'polite');
  }
});
</script>
</body>
</html>
