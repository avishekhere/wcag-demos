<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>WCAG 2.1 – 4.1.3: Accessible Status Messages Demo</title>
<style>
  body { font-family: Arial, sans-serif; background: #f7f7fb; margin: 0; padding: 0; color: #111; }
  .wrap { max-width: 800px; margin: 30px auto; padding: 20px; background: #fff; border-radius: 12px; box-shadow: 0 6px 16px rgba(0,0,0,0.08);}
  h1 { margin-top: 0; font-size: 24px; }
  h2 { font-size: 20px; margin-bottom: 8px; }
  form { margin-top: 10px; }
  input { padding: 6px; margin-bottom: 10px; width: 100%; max-width: 300px; border-radius: 6px; border: 1px solid #ccc; }
  button { padding: 8px 16px; border-radius: 6px; border: none; background: #0b7a2a; color: #fff; cursor: pointer; }
  button:hover { background: #095c1f; }
  select { padding: 6px; border-radius: 6px; margin-left: 8px; }
  .status { margin-top: 12px; padding: 10px; border-radius: 6px; }
  .status.unsafe { background: #fff1f1; color: #b70f0f; }
  .status.safe { background: #e9f7ed; color: #0b7a2a; }
  .note { font-size: 13px; color: #666; margin-top: 6px; }
</style>
</head>
<body>
<div class="wrap">
  <h1>WCAG 2.1 – 4.1.3: Ensure Accessible Status Messages</h1>
  <p class="note">Select whether the status messages are accessible (ARIA live) or not, and submit the form to see the behavior.</p>

  <label for="status-type">Select Status Message Type:</label>
  <select id="status-type">
    <option value="unsafe">Unsafe: Not announced by screen readers</option>
    <option value="safe">Safe: Accessible with ARIA live regions</option>
  </select>

  <form id="demo-form">
    <label for="name">Name:</label>
    <input type="text" id="name" name="name" required>

    <label for="email">Email:</label>
    <input type="email" id="email" name="email" required>

    <button type="submit">Submit</button>
  </form>

  <div id="status-message" class="status unsafe" style="display:none;">
    Your form has been successfully submitted.
  </div>

  <div id="field-errors" class="status unsafe" style="display:none;">
    <!-- Field-level errors will appear here -->
  </div>

  <p class="note">Notes:</p>
  <ul class="note">
    <li>Unsafe: Status messages appear visually but are not announced by screen readers.</li>
    <li>Safe: Status messages and field errors use <code>role="status"</code> and/or <code>aria-live="polite"</code> to be announced programmatically.</li>
  </ul>
</div>

<script>
const form = document.getElementById('demo-form');
const status = document.getElementById('status-message');
const fieldErrors = document.getElementById('field-errors');
const statusType = document.getElementById('status-type');

form.addEventListener('submit', function(event) {
  event.preventDefault();

  let name = document.getElementById('name').value.trim();
  let email = document.getElementById('email').value.trim();
  let errors = [];

  if(!name) errors.push("Please enter your name.");
  if(!email) errors.push("Please enter your email.");

  // Reset messages
  status.style.display = 'none';
  fieldErrors.style.display = 'none';
  status.innerHTML = '';
  fieldErrors.innerHTML = '';

  if(errors.length > 0){
    // Show field-level errors
    fieldErrors.style.display = 'block';
    fieldErrors.innerHTML = errors.join('<br>');

    if(statusType.value === 'unsafe'){
      fieldErrors.className = 'status unsafe';
      fieldErrors.removeAttribute('role');
      fieldErrors.removeAttribute('aria-live');
    } else {
      fieldErrors.className = 'status safe';
      fieldErrors.setAttribute('role','status');
      fieldErrors.setAttribute('aria-live','polite');
    }
    return;
  }

  // Success message
  status.style.display = 'block';
  status.innerHTML = "Your form has been successfully submitted.";
  if(statusType.value === 'unsafe'){
    status.className = 'status unsafe';
    status.removeAttribute('role');
    status.removeAttribute('aria-live');
  } else {
    status.className = 'status safe';
    status.setAttribute('role','status');
    status.setAttribute('aria-live','polite');
  }
});
</script>
</body>
</html>
