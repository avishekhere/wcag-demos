<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>WCAG 2.1 – 3.3.4 Demo: Critical User Error Prevention</title>
<style>
  body { font-family: Arial, sans-serif; background: #f2f2f7; color: #111; margin: 0; padding: 0; }
  .container { max-width: 800px; margin: 30px auto; padding: 20px; background: #fff; border-radius: 12px; box-shadow: 0 6px 16px rgba(0,0,0,0.08); }
  h1 { font-size: 24px; margin-top: 0; }
  h2 { font-size: 20px; margin-top: 20px; }
  label { display: block; margin-top: 12px; }
  input, select { padding: 6px; border-radius: 6px; border: 1px solid #ccc; width: 100%; margin-top: 4px; }
  button { margin-top: 12px; padding: 8px 12px; border-radius: 6px; border: 1px solid #007bff; background: #007bff; color: #fff; cursor: pointer; }
  .result { margin-top: 10px; font-weight: 600; }
  .result.pass { color: #0b7a2a; }
  .result.fail { color: #b70f0f; }
  .review-box { background: #eef; padding: 12px; border-radius: 6px; margin-top: 12px; }
  .note { font-size: 13px; color: #666; margin-top: 4px; }
</style>
</head>
<body>
<div class="container">
  <h1>WCAG 2.1 – 3.3.4: Preventing Critical User Errors</h1>

  <label for="demo-mode"><strong>Choose Demo Mode:</strong></label>
  <select id="demo-mode">
    <option value="unsafe">Unsafe / Fail</option>
    <option value="safe">Safe / Pass</option>
  </select>

  <!-- Online Payment Form -->
  <section class="example">
    <h2>Online Payment Form</h2>
    <form id="paymentForm">
      <label for="taxid">Tax ID:</label>
      <input type="text" id="taxid" name="taxid" placeholder="Enter Tax ID">

      <label for="amount">Payment Amount:</label>
      <input type="number" id="amount" name="amount" placeholder="Enter amount in INR">

      <button type="submit">Submit Payment</button>
    </form>

    <div id="review-section" class="review-box" style="display:none;">
      <h3>Review Your Submission</h3>
      <p id="review-text"></p>
      <button id="confirmBtn">Confirm & Pay</button>
      <button id="editBtn">Edit</button>
    </div>

    <div id="form-result" class="result"></div>
    <p class="note">Test by entering wrong Tax ID or amount. Switch between modes to see fail/pass behavior.</p>
  </section>

  <!-- Legal Commitment Form -->
  <section class="example">
    <h2>Online Rental Agreement / Consent Form</h2>
    <form id="legalForm">
      <label for="fullname">Full Name:</label>
      <input type="text" id="fullname" name="fullname" placeholder="Enter your full name">

      <label for="emailLegal">Email:</label>
      <input type="email" id="emailLegal" name="emailLegal" placeholder="Enter your email">

      <label>
        <input type="checkbox" id="agreeLegal" name="agreeLegal">
        I agree to the terms and conditions
      </label>

      <button type="submit">Submit Agreement</button>
    </form>

    <div id="review-legal-section" class="review-box" style="display:none;">
      <h3>Review Your Agreement</h3>
      <p id="review-legal-text"></p>
      <button id="confirmLegalBtn">Confirm & Submit</button>
      <button id="editLegalBtn">Edit</button>
    </div>

    <div id="legal-result" class="result"></div>
    <p class="note">Test by leaving fields blank or not checking the agreement. Switch between modes to see fail/pass behavior.</p>
  </section>
</div>

<script>
const demoMode = document.getElementById('demo-mode');

// Payment Form Elements
const paymentForm = document.getElementById('paymentForm');
const taxInput = document.getElementById('taxid');
const amountInput = document.getElementById('amount');
const reviewSection = document.getElementById('review-section');
const reviewText = document.getElementById('review-text');
const confirmBtn = document.getElementById('confirmBtn');
const editBtn = document.getElementById('editBtn');
const formResult = document.getElementById('form-result');

// Legal Form Elements
const legalForm = document.getElementById('legalForm');
const fullnameInput = document.getElementById('fullname');
const emailLegalInput = document.getElementById('emailLegal');
const agreeCheckbox = document.getElementById('agreeLegal');
const reviewLegalSection = document.getElementById('review-legal-section');
const reviewLegalText = document.getElementById('review-legal-text');
const confirmLegalBtn = document.getElementById('confirmLegalBtn');
const editLegalBtn = document.getElementById('editLegalBtn');
const legalResult = document.getElementById('legal-result');

function setDemoMode(mode) {
  // Payment Form
  paymentForm.onsubmit = (e) => {
    e.preventDefault();
    formResult.textContent = '';
    formResult.className = 'result';
    formResult.removeAttribute('role');
    formResult.removeAttribute('aria-live');
    reviewSection.style.display = 'none';
    reviewText.removeAttribute('role');
    reviewText.removeAttribute('aria-live');

    const taxID = taxInput.value.trim();
    const amount = amountInput.value.trim();

    if(mode === 'unsafe') {
      if(!taxID || !amount) {
        formResult.textContent = '⚠️ Error! Missing information.';
        formResult.className = 'result fail';
      } else {
        formResult.textContent = 'Payment Submitted! (No review, cannot undo)';
        formResult.className = 'result fail';
      }
      return;
    }

    // Safe mode
    let errors = [];
    if(!taxID) errors.push('Tax ID is required.');
    if(!amount || isNaN(amount) || Number(amount)<=0) errors.push('Enter a valid payment amount.');

    if(errors.length > 0) {
      formResult.innerHTML = errors.map(e => `<div>${e}</div>`).join('');
      formResult.className = 'result fail';
      formResult.setAttribute('role','status');
      formResult.setAttribute('aria-live','polite');
      return;
    }

    reviewText.textContent = `You are about to pay ₹${amount} for Tax ID: ${taxID}.`;
    reviewSection.style.display = 'block';
    reviewText.setAttribute('role','status');
    reviewText.setAttribute('aria-live','polite');
  };

  confirmBtn.onclick = () => {
    reviewSection.style.display = 'none';
    formResult.textContent = '✅ Payment Successfully Submitted!';
    formResult.className = 'result pass';
    if(mode === 'safe') {
      formResult.setAttribute('role','status');
      formResult.setAttribute('aria-live','polite');
    }
  };

  editBtn.onclick = () => {
    reviewSection.style.display = 'none';
    formResult.textContent = '✏️ You can edit your details now.';
    formResult.className = 'result fail';
    if(mode === 'safe') {
      formResult.setAttribute('role','status');
      formResult.setAttribute('aria-live','polite');
    }
  };

  // Legal Form
  legalForm.onsubmit = (e) => {
    e.preventDefault();
    legalResult.textContent = '';
    legalResult.className = 'result';
    legalResult.removeAttribute('role');
    legalResult.removeAttribute('aria-live');
    reviewLegalSection.style.display = 'none';
    reviewLegalText.removeAttribute('role');
    reviewLegalText.removeAttribute('aria-live');

    const name = fullnameInput.value.trim();
    const email = emailLegalInput.value.trim();
    const agreed = agreeCheckbox.checked;

    if(mode === 'unsafe') {
      if(!name || !email || !agreed) {
        legalResult.textContent = '⚠️ Error! Missing information or agreement not checked.';
        legalResult.className = 'result fail';
      } else {
        legalResult.textContent = 'Agreement Submitted! (No review, cannot undo)';
        legalResult.className = 'result fail';
      }
      return;
    }

    // Safe mode
    let errors = [];
    if(!name) errors.push('Full name is required.');
    if(!email) errors.push('Valid email is required.');
    if(!agreed) errors.push('You must agree to the terms.');

    if(errors.length > 0) {
      legalResult.innerHTML = errors.map(e => `<div>${e}</div>`).join('');
      legalResult.className = 'result fail';
      legalResult.setAttribute('role','status');
      legalResult.setAttribute('aria-live','polite');
      return;
    }

    reviewLegalText.textContent = `Name: ${name}\nEmail: ${email}\nAgreement: Accepted`;
    reviewLegalSection.style.display = 'block';
    reviewLegalText.setAttribute('role','status');
    reviewLegalText.setAttribute('aria-live','polite');
  };

  confirmLegalBtn.onclick = () => {
    reviewLegalSection.style.display = 'none';
    legalResult.textContent = '✅ Agreement Successfully Submitted!';
    legalResult.className = 'result pass';
    if(mode === 'safe') {
      legalResult.setAttribute('role','status');
      legalResult.setAttribute('aria-live','polite');
    }
  };

  editLegalBtn.onclick = () => {
    reviewLegalSection.style.display = 'none';
    legalResult.textContent = '✏️ You can edit your agreement now.';
    legalResult.className = 'result fail';
    if(mode === 'safe') {
      legalResult.setAttribute('role','status');
      legalResult.setAttribute('aria-live','polite');
    }
  };
}

// Initialize demo mode
demoMode.addEventListener('change', () => setDemoMode(demoMode.value));
demoMode.dispatchEvent(new Event('change'));
</script>
</body>
</html>
